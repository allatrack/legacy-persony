
<script type="text/ng-template" id="photoModal.html">
    <div class="modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" ng-click="$hide()">×</button>
                    <h4 class="modal-title" id="event1ImageModalLabel" ng-bind-html="title"></h4>
                </div>
                <div class="modal-body" ng-bind-html="content"></div>
            </div>
        </div>
    </div>
</script>

<script type="text/ng-template" id="personModal.html">
    <div class="modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" ng-click="$hide()">×</button>
                    <h4 class="modal-title" id="event1ImageModalLabel">{{person.name}}</h4>
                </div>
                <div class="modal-body">
                    <div class='person-modal'>

                        <div class="person-photo pull-left">
                            <img
                                    ng-src="{{person.getPhotoSrc()}}"
                                    alt="{{person.name}}"
                                    title="{{person.name}}"
                                    ng-click="personPopup()"
                                    ng-if="person.getPhotoSrc()"
                                    />

                            <img
                                    src="/images/apple-touch-icon-114x114.png"
                                    alt="Фотографії не існує"
                                    title="{{person.name}}"
                                    ng-click="personPopup()"
                                    ng-if="!person.getPhotoSrc()"
                                    />
                        </div>

                        <div class="person-data pull-left">

                            <div class="person-info">{{person.info}}</div>

                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<div class="person-header-die"></div>
<div class="container" person-details>
    <div class="page-header">

        <div class="timeline-zoom">
            <div class="zoom-tip">
                Маштаб часу:
            </div>
            <div class="slider-instead">
                Десятиріччя
            </div>
            <i class="fa fa-plus"></i>
            <rzslider rz-slider-model="zoomSlider"
                      rz-slider-floor="0"
                      rz-slider-ceil="7"
                      rz-slider-translate="translate">
            </rzslider>
            <i class="fa fa-minus"></i>
        </div>

        <div class='person-header'>

            <div class="person-photo pull-left">
                <img
                        ng-src="{{person.getPhotoSrc()}}"
                        alt="{{person.name}}"
                        title="{{person.name}}"
                        ng-click="personPopup()"
                        ng-if="person.getPhotoSrc()"
                        />

                <img
                        src="/images/apple-touch-icon-114x114.png"
                        alt="Фотографії не існує"
                        title="{{person.name}}"
                        ng-click="personPopup()"
                        ng-if="!person.getPhotoSrc()"
                        />
            </div>

            <div class="person-data pull-left">

                <h3 class="pull-left person-name" data-animation="am-fade-and-slide-top" data-placement="center" data-template="personModal.html" bs-modal="modal">{{person.name}}</h3>

                <!--div class="social-likes social-likes_single social-likes_light" data-single-title="Поширити"
                     ng-if="false">
                    <div class="facebook" title="Поширити на Фейсбуці">Facebook</div>
                    <div class="twitter" title="Твітнути">Twitter</div>
                    <div class="vkontakte" title="Поширити у Вконтакті">Вконтакте</div>
                    <div class="plusone" title="Поширити за допомогою Гугл">Google+</div>
                </div-->
                <div class="clearfix"></div>

                <div class="person-info">{{person.info}}</div>

            </div>

        </div>

        <div class="pull-right">
            <div class="person-tools">
                <a class="dropdown-toggle" data-animation="am-flip-x" bs-dropdown="dropdownPersonTools" data-html="true">
                    <i class="fa fa-cog fa-2x"></i>
                </a>
            </div>

            <div class="event-filter">
                <a class="dropdown-toggle" data-animation="am-flip-x" bs-dropdown="dropdownEventFilters" data-html="true">
                    <i class="fa fa-filter fa-lg"></i><span>Фільтрувати події</span>
                </a>
            </div>
        </div>

    </div>

    <div class="panel panel-default timeline-helper">
        <div class="panel-body" role="complementary" bs-scrollspy-list>
            <ul>
                <li bs-scrollspy data-offset="{{spyoffset}}" data-target="#year{{year}}" ng-repeat="year in eventYears.orders.years" class="helper-year">
                    <a ng-href="/persons/{{person.id}}#year{{year}}" class="helper-year-link">{{year}}</a>
                    <ul>
                        <li bs-scrollspy data-offset="{{spyoffset}}" data-target="#year{{year}}month{{month}}" ng-repeat="month in eventYears.orders.months[year]" class="helper-month">
                            <a ng-href="/persons/{{person.id}}#year{{year}}month{{month}}" class="helper-month-link">{{month | monthName}}</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

	<div class="container loading" ng-hide="contentLoaded">
	   	<i class="fa fa-spinner fa-spin fa-5x"></i>
	</div>

    <div class="person-bio" ng-show="contentLoaded">
    	<script>
    		function labelClicked(e) {
    			var event = e || window.event;
    			var checkbox = $('input#' + $(event.target).attr('for'));
    			if (checkbox.prop('checked') && event.preventDefault) {
    				event.preventDefault();	
    				checkbox.prop('checked', null);
    			}
    		}
    	</script>
        <ul id='timeline'>
            <li class="li-year" ng-repeat="year in eventYears.orders.years" id="year{{year}}" on-last-repeat>
                <div class="event-year">{{year}}</div>
                <ul class="event-monthes-list">
                    <li class="li-month" ng-repeat="month in eventYears.orders.months[year]" id="year{{year}}month{{month}}">
                        <div class="event-month">{{month | monthName}}</div>
                        <ul class="events-list">
                            <li ng-repeat="event in eventYears[year][month]">
                                <input class='radio' id='event{{event.id}}' name='events' type='radio'>
                                <a id="#event_{{event.id}}"></a>
                                <div class="relative">
                                    <a class="timeline-anchor" id="event-ancor{{event.id}}"></a>
                                    <label for='event{{event.id}}' onClick='labelClicked();'>{{event.title}}</label>

                                    <div class="event-date">{{event.start | date:"d"}}</div>
                                    <div class="event-icon fa fa-lg fa-{{event.sources[0].icon || 'info'}}"></div>
                                </div>
                                <div class='content'>
                                    <div class="event-header">
                                        <div class="event-detail-date">
                                            {{event.start | date:"d MMMM"}}
                                        </div>

                                        <div class="event-tools">
                                            <div class="dropdown">
                                                <a class="dropdown-toggle" data-animation="am-flip-x" bs-dropdown="dropdownEventTools" data-html="true">
                                                    <i class="fa fa-cog fa-2x"></i>
                                                </a>
                                                <ul class="dropdown-menu pull-right">
                                                    <li>
                                                        <a ng-click="addEditEvent(event)">Редагувати</a>
                                                        <a>Поскаржитись</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="detail-info">
                                        <div class="info-wrap-img">
                                            <img ng-src="{{event.getImageSrc()}}"
                                                 alt="{{event.title}}"
                                                 title="{{event.title}}"
                                                 ng-click="popupEventPhoto(event)"
                                                 ng-if="event.getImageSrc()"
                                                    />
                                        </div>
                                        <div class="info-wrap">
                                            <p class="description">{{event.description}}</p>

                                            <p class="source">
                                                Джерел{{event.sources.length > 1 ? 'а': 'о'}}: 
                                                <span ng-repeat="source in event.sources">{{$index === 0 ? '' : ', '}}<a
                                                    ng-href="{{source.link}}" external-link>{{source.title}}</a></span>
                                            </p>

                                            <div class="share" id="share_{{event.id}}" data-url="{{HOST_URL}}/persons/{{person.id}}#{{event.id}}" data-title="{{event.title}}">
                                                <div class="facebook" title="Поділитись у Фейсбуці">Facebook</div>
                                                <div class="twitter" title="Твітнути">Twitter</div>
                                                <div class="vkontakte" title="Поділитись у Вконтакті">Vkontakte</div>
                                                <div class="plusone" title="Поділитись у Гугл">Google+</div>
                                            </div>

                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </li>
        </ul>
    </div>
</div>
